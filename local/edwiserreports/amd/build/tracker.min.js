"use strict";define(["jquery","core/ajax","core/notification","./defaultconfig"],function(e,n,t,i){var a={IS_INSTALLED:function(){return e.ajax({url:i.requestUrl,type:i.requestType,dataType:i.requestDataType,data:{action:"is_installed_ajax"}})},GET_TRACKING_DETAILS:function(e){return n.call([{methodname:"local_edwiserreports_get_tracking_details",args:{contextid:e}}])[0]},KEEP_ALIVE:function(e){return n.call([{methodname:"local_edwiserreports_keep_alive",args:{id:r,time:e}}],!0,!1,!0)[0]}},r=null,o=null,l=0,c=null;function u(){null!==r&&0!==l&&(a.KEEP_ALIVE(l),l=0)}function d(){null!==r&&(o=setInterval(function(){++l>=c&&u()},1e3))}function s(){a.GET_TRACKING_DETAILS(M.cfg.contextid).done(function(e){!1!==e.status&&(r=e.id,c=e.frequency,window.addEventListener("beforeunload",function(e){u(),clearInterval(o)}),document.addEventListener("visibilitychange",function(e){"visible"==document.visibilityState?d():clearInterval(o)}),"visible"==document.visibilityState&&d())}).fail(t.exception)}return{init:function(){void 0===window.timerinit&&(window.timerinit=!0,a.IS_INSTALLED().done(function(e){e.installed&&s()}))}}}),window.addEventListener("load",function(){require(["local_edwiserreports/tracker"],function(e){e.init()})},!1);
//# sourceMappingURL=tracker.min.js.map
