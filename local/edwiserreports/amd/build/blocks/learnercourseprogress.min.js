"use strict";define("local_edwiserreports/blocks/learnercourseprogress",["jquery","local_edwiserreports/vendor/apexcharts","local_edwiserreports/common","local_edwiserreports/defaultconfig","local_edwiserreports/select2"],function(e,t,r,o){var a=null,s={course:0,dir:e("html").attr("dir"),rtl:"rtl"==e("html").attr("dir")?1:0},l={series:[],chart:{type:"bar",height:350,toolbar:{show:!1,tools:{download:!1,reset:'<i class="fa fa-refresh"></i>'}},zoom:{enabled:!1}},tooltip:{enabled:!0,enabledOnSeries:void 0,shared:!0,followCursor:!1,intersect:!1,inverseOrder:!1,fillSeriesColor:!1,onDatasetHover:{highlightDataSeries:!1},marker:{show:!0},items:{display:"flex"},fixed:{enabled:!1,position:"topRight",offsetX:0,offsetY:0},y:{title:{}}},grid:{borderColor:"#e7e7e7"},dataLabels:{enabled:!1},xaxis:{categories:null,labels:{hideOverlappingLabels:!0,trim:!0,rotate:300,minHeight:100,maxHeight:120}},legend:{position:"top",horizontalAlign:"left",offsetY:"-20",itemMargin:{horizontal:10,vertical:0}},noData:{text:M.util.get_string("nographdata","local_edwiserreports")},colors:[o.getColorTheme()[2]]},n=s.rtl?"left":"right",i={chart:{type:"donut",height:350},legend:{position:n,formatter:function(e,t){return[e+": "+t.w.globals.series[t.seriesIndex]]}},dataLabels:{enabled:!1},noData:{text:M.util.get_string("nographdata","local_edwiserreports")},colors:o.getColorTheme()},c={PANEL:"#learnercourseprogressblock",COURSE:"#learnercourseprogress-course-select",GRAPH:"#apex-chart-learnercourseprogress-block"},d={GET_COURSEPROGRESS:function(t){return e.ajax({url:o.requestUrl,type:o.requestType,dataType:o.requestDataType,data:{action:"get_learnercourseprogress_graph_data_ajax",secret:M.local_edwiserreports.secret,lang:e("html").attr("lang"),data:JSON.stringify({filter:t})}})}};function g(){var o;r.loader.show(c.PANEL),d.GET_COURSEPROGRESS(s).done(function(n){0==s.course?((o=Object.assign({},l)).yaxis={max:100,labels:{formatter:function(e){return e+"%"}}},o.xaxis.categories=n.labels,o.series=[{name:M.util.get_string("courseprogress","local_edwiserreports"),data:n.progress}],o.chart.toolbar.show=n.labels.length>30,o.chart.zoom.enabled=n.labels.length>30,o.tooltip.y.title.formatter=function(e){return M.util.get_string("progress","local_edwiserreports")+": "},e(c.PANEL).find(".panel-body").attr("data-charttype","bar")):((o=Object.assign({},i)).labels=n.labels,o.series=n.progress,o.tooltip={custom:function(e){var t=e.series,r=e.seriesIndex,o=(e.dataPointIndex,e.w),a=t[r],s=o.config.labels[r],l=a<2?n.tooltip.single:n.tooltip.plural,i=o.config.colors[r];return'<div class="custom-donut-tooltip" style="color: '.concat(i,';">\n                                    <span style="font-weight: 500;"> ').concat(s,':</span>\n                                    <span style="font-weight: 700;"> ').concat(a," ").concat(l,"</span>\n                                </div>")}},e(c.PANEL).find(".panel-body").attr("data-charttype","donut")),function(e,o){null!==a&&a.destroy(),(a=new t(e.get(0),o)).render(),setTimeout(function(){r.loader.hide(c.PANEL)},1e3)}(e(c.PANEL).find(c.GRAPH),o)}).fail(function(e){r.loader.hide(c.PANEL)})}return{init:function(t){0!=e(c.PANEL).length&&(e(c.PANEL).find(".singleselect").select2(),e("body").on("change","".concat(c.PANEL," ").concat(c.COURSE),function(){var t=parseInt(e(this).val());s.course=t,g()}),setInterval(function(){if(null!==a){var t=e(c.PANEL).find(c.GRAPH).width(),r=t>=400?"right":"bottom";"rtl"==e("html").attr("dir")&&(r=t>=400?"left":"bottom"),r!=n&&(n=r,a.updateOptions({legend:{position:n}}))}},1e3),g())}}});
//# sourceMappingURL=learnercourseprogress.min.js.map
